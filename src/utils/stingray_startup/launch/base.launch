<launch>
    <!-- Launch file of Stingray for real AUV -->

    <!-- ARGS -->

    <!-- COMMON -->
    <!-- Settings for "output" parameter of nodes -->
    <arg name="ros_output" default="screen" />
    <!-- Debug mode. Enabled output images publishing after yolo prediction -->
    <arg name="debug" default="true" />
    <!-- Enables connection with hardware platform -->
    <arg name="hardware_connection" default="true" />

    <!-- UART SETTINGS -->
    <arg name="uart_device" default="/dev/ttyS0" />
    <arg name="uart_baudrate" default="57600" />
    <arg name="uart_data_bytes" default="8" />
    <!-- Available parity values: none, even, odd -->
    <arg name="uart_parity" default="none" />
    <arg name="uart_stop_bits" default="1" />

    <!-- MOVEMENT -->
    <!-- Coefficient for transforming velocity value from range 0.0 to 1.0 to real vehicle range -->
    <arg name="velocity_coefficient" default="20000.0" />

    <!-- MISSIONS -->
    <!-- Enables missions -->
    <arg name="missions_enabled" default="false" />
    <!-- Missions FSM module -->
    <arg name="missions_module" default="" />
    <!-- Missions FSM class -->
    <arg name="missions_class" default="" />
    <!-- Delay after initialization that is used to put vehicle into the pool, in milliseconds -->
    <arg name="delay_after_init" default="50000" />
    <!-- FSM visualization using SMACH viewer -->
    <arg name="fsm_introspection" default="false" />

    <!-- WEIGHTS -->
    <!-- Package name with your dnn weights -->
    <arg name="weights_pkg_name" default="stingray_object_detection" />

    <!-- NODES -->
    <!-- object_detection launch file-->
<!--    <include file="$(find stingray_startup)/launch/object_detection.launch"> КАЖЕТСЯ ЭТО НУЖНО УДАЛИТЬ, ТК ОНО ДОЛЖНО ЗАПУСКАТЬСЯ ИЗ (sauvc_vision)/launch/object_detector.launch-->
<!--        <arg name="real_cam" value="true" />-->
<!--        <arg name="debug" value="$(arg debug)" />-->
<!--        <arg name="weights_pkg_name" value="$(arg weights_pkg_name)" />-->
<!--    </include>-->

    <!-- Connection with real vehicle -->
    <node pkg="nodelet" type="nodelet" name="standalone_nodelet"  args="manager" output="$(arg ros_output)" respawn="true"/>
    <group if="$(arg hardware_connection)">
        <node pkg="nodelet" type="nodelet" name="uart_driver" args="load stingray_communication/uart_driver standalone_nodelet" output="$(arg ros_output)" respawn="true">
            <param name="device" value="$(arg uart_device)" />
            <param name="baudrate" value="$(arg uart_baudrate)" />
            <param name="data_bytes" value="$(arg uart_data_bytes)" />
            <param name="parity" value="$(arg uart_parity)" />
            <param name="stop_bits" value="$(arg uart_stop_bits)" />
        </node>
    </group>
    <node pkg="nodelet" type="nodelet" name="hardware_bridge" args="load stingray_communication/hardware_bridge standalone_nodelet" output="$(arg ros_output)" respawn="true"/>

    <!-- Movement nodes, real vehicle -->
    <node pkg="stingray_movement" type="basic_movement" name="basic_movement" output="$(arg ros_output)" respawn="true">
        <param name="velocity_coefficient" value="$(arg velocity_coefficient)" />
    </node>
    <node pkg="stingray_movement" type="movement_patterns" name="movement_patterns" output="$(arg ros_output)" respawn="true">
        <param name="velocity_coefficient" value="$(arg velocity_coefficient)" />
    </node>

    <!-- QR reader -->
    <node name="usb_cam" pkg="usb_cam" type="usb_cam_node" output="screen" >
        <param name="video_device" value="/dev/video0" />
        <param name="image_width" value="640" />
        <param name="image_height" value="480" />
        <param name="pixel_format" value="yuyv" />
        <param name="camera_frame_id" value="usb_cam" />
        <param name="io_method" value="mmap"/>
    </node>

    <node pkg="zbar_ros" type="barcode_reader_node" name="barcode_reader" output="screen">
        <remap from="image" to="/usb_cam/image_raw" />
    </node>

    <node pkg="stingray_startup" type="qr_trigger.py" name="qr_trigger" output="screen" />

</launch>
